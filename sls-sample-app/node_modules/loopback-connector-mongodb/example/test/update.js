var DataSource = require('loopback-datasource-juggler').DataSource;

var config = require('rc')('loopback', {test: {mongodb: {}}}).test.mongodb;

var f = function () {
  var db = new DataSource(require('../../.'), config);
  db.log = function (a) {
    console.log(a);
  };

  return db;
};

var db = f();
var Post = db.createModel('posttest', {title: String, content: String});

Post.create({title: 'a', content: 'AAA'}, function (err, post) {
  post.title = 'b';
  Post.updateOrCreate(post, function (err, p) {
    console.log(p);
    Post.findById(post.id, console.log);
  });

});
